!function(t){if(!(t.browser.msie&&t.browser.version<=8)){var a=function(a){if(void 0===window.galleries)return null;var e=null;return t.each(window.galleries,function(t,n){n.ID==a&&(e=n)}),e},e=function(t,a,e){var n=e;return n=void 0!==t.display_settings[a]&&""!=t.display_settings[a]?t.display_settings[a]:e,1==n&&(n=!0),0==n&&(n=!1),"1"==n&&(n=!0),"0"==n&&(n=!1),"false"==n&&(n=!1),"true"==n&&(n=!0),n},n=["EM","STRONG","B","DEL","I","INS","MARK","SMALL","STRIKE","SUB","SUP","TT","U"],i=function(t){var a=document.createElement("div");return a.innerHTML=t,r(a),a.innerHTML},r=function(t){for(var a=Array.prototype.slice.apply(t.getElementsByTagName("*"),[0]),e=0;e<a.length;e++)-1==n.indexOf(a[e].nodeName)&&o(a[e])},o=function(t){for(var a=t,e=t.childNodes.length-1;e>=0;e--){var n=t.removeChild(t.childNodes[e]);t.parentNode.insertBefore(n,a),a=n}t.parentNode.removeChild(t)};nggc_share_icons={strip_html:function(t){var a=document.createElement("div");return a.innerHTML=t,a.textContent||a.innerText||""},create:function(a,e){var n=e.data("image-id"),i=e.data("nplmodal-gallery-id"),r=encodeURIComponent(this.get_share_url(i,n)),o=encodeURIComponent(window.location.toString()),s=this.strip_html(e.data("title")),d=this.strip_html(e.data("description")),g=t("<i/>",{"data-href":"https://twitter.com/share?url="+this.get_share_url(i,n,"full"),class:"ngg-caption-icon fa fa-twitter-square"}),c=t("<i/>",{"data-href":"https://plus.google.com/share?url="+r,class:"ngg-caption-icon fa fa-google-plus-square"}),l="&p[url]="+encodeURIComponent(this.get_share_url(i,n,"full"));s.length>0&&(l+="&p[title]="+s.trim()),d.length>0&&(l+="&p[summary]="+d.trim()),l+="&p[images][0]="+encodeURIComponent(e.attr("href")).trim();var p=t("<i/>",{"data-href":"https://www.facebook.com/sharer/sharer.php?s=100"+l,class:"ngg-caption-icon fa fa-facebook-square"}),h=encodeURIComponent(this.get_share_url(i,n,"full"));h+="&url="+o,h+="&media="+e.attr("href"),h+="&description="+d;var f=t("<i/>",{"data-href":"http://pinterest.com/pin/create/button/?s=100"+h,class:"ngg-caption-icon fa fa-pinterest-square"}),u=[g,c,p,f];t(u).each(function(){t(this).on("click",function(a){return a.preventDefault(),window.open(t(this).data("href"),"_blank").focus(),!1})}),a.html("").append(u)},get_share_url:function(a,e,n){void 0===n&&(n="thumb");var i=t.nplModal("get_setting","share_url").replace("{gallery_id}",a).replace("{image_id}",e).replace("{named_size}",n),r=t("<a/>").attr("href",t.nplModal("get_setting","wp_site_url"))[0],o=t("<a/>").attr("href",window.location.toString())[0],s=t("<a/>").attr("href",i)[0];return o.pathname.indexOf(r.pathname)>=0&&(o.pathname=o.pathname.substr(r.pathname.length)),o.pathname.indexOf(s.pathname)>=0&&(o.pathname=o.pathname.substr(o.pathname.length)),s.search=o.search,s.search.length>0&&(s.search+="&"),s.search+="uri="+o.pathname,s.href}},t.fn.nggcaption=function(){this.each(function(){var n=t(this);if(n.data("ngg-captions-processed"))return!0;var r=a(n.data("ngg-captions-id")),o=e(r,"captions_animation","slideup"),d=n.find("img").first();if(!d.attr("src")&&!d.attr("srcset"))return!0;n.data("ngg-captions-processed",1);var g=t('<figure class="ngg-figure"></figure>'),c=t('<figcaption class="ngg-figcaption"></figcaption>'),l=t("<h6>"+i(n.data("title"))+"</h6>");e(r,"captions_display_title",!0)||g.addClass("nggc_no_title");var p=t("<div/>").addClass("nggc-body"),h=t('<p data-ngg-original-description="'+i(n.data("description"))+'"></p>');e(r,"captions_display_title",!0)||h.html(i(n.data("description"))),p.append(h),e(r,"captions_display_description",!0)||g.addClass("nggc_no_description");var f=n.attr("class"),u=n.attr("style"),m=d.attr("style");if(n.removeAttr("title"),n.data("ngg-captions-nostylecopy")||(n.removeAttr("class"),n.removeAttr("style")),g.addClass("ngg-figure-"+o),c.addClass("ngg-figcaption-"+o),-1==t.inArray(r.source,["albums","random","random_images"])&&void 0!==window.nplModalSettings&&"1"==nplModalSettings.enable_routing&&"1"==nplModalSettings.enable_sharing&&e(r,"captions_display_sharing",!0)){var _=r.slug;if(!_||-1==_.indexOf("widget-ngg-images")){var v=t('<div class="nggc-icon-wrapper"/>');nggc_share_icons.create(v,n),t(document).trigger("ngg-caption-add-icons",{el:v,image_id:n.data("image-id"),gallery_id:n.data("nplmodal-gallery-id")}),c.append(v)}}else g.addClass("nggc_no_sharing");e(r,"captions_display_title",!0)&&c.append(l),e(r,"captions_display_description",!0)&&c.append(p),t.browser.msie&&(9==t.browser.version&&t(g).addClass("nggc-ie9"),10==t.browser.version&&t(g).addClass("nggc-ie10")),n.data("ngg-captions-nostylecopy")||(g.attr("style",m),g.attr("style",u)),d.removeAttr("style"),n.data("ngg-captions-nostylecopy")||g.css({"max-width":parseInt(d[0].getAttribute("width"))+"px"}),$newfigure=d.wrap(g),d.after(c),n.data("ngg-captions-nostylecopy")||$newfigure.addClass(f),$newfigure.imagesLoaded().done(function(){s(l),s(p)}),$newfigure.parent("p").before($newfigure)}),t(document).trigger("ngg-captions-added")};var s=function(n){void 0===n&&(n=t("figcaption.ngg-figcaption h6, figcaption.ngg-figcaption .nggc-body")),t("div.nextgen_pro_thumbnail_grid a").each(function(){var a=t(this),e=a.find("img");e.hasClass("thickbox")&&(e.removeClass("thickbox"),a.addClass("thickbox"))}),n.each(function(){var n=t(this),r=a(n.parents("a").first().data("ngg-captions-id")),o=e(r,"captions_animation","slideup");n.dotdotdot({callback:function(t,a){if("H6"==n.prop("tagName"))if(t&&"titlebar"!=o)t&&"titlebar"!=o&&n.next("div").find("p").text("");else{var e=n.next("div").find("p");e.html(i(e.data("ngg-original-description")))}t&&!n.hasClass("nggc-dotdotdot")&&n.addClass("nggc-dotdotdot"),!t&&n.hasClass("nggc-dotdotdot")&&n.removeClass("nggc-dotdotdot")}})})},d=function(a){a=a||!1,t("a").each(function(){var e=t(this);e.data("ngg-captions-enabled")&&!e.data("ngg-captions-processed")&&(a?t(window).on("load",function(){e.nggcaption()}):e.nggcaption())})};d(!0),t(window).on("refreshed",function(){d(),s()}),t(window).on("resize fullscreenchange mozfullscreenchange webkitfullscreenchange orientationchange",function(){t("figcaption.ngg-figcaption h6, figcaption.ngg-figcaption .nggc-body").each(function(){t(this).trigger("update.dot")})})}}(jQuery);